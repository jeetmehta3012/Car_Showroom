function guid(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function htmlUnescape(e){return String(e).replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function ajaxCall(e,n,t){var o=!1,i=!1;return window.XMLHttpRequest&&"withCredentials"in(o=new XMLHttpRequest)&&(i=!0),!!o&&(o.onreadystatechange=function(){t&&4==this.readyState&&200==this.status&&t(this.responseText)},n?(o.open("POST",e,!0),o.setRequestHeader&&o.setRequestHeader("Content-type","text/plain")):o.open("GET",e,!0),i&&(o.withCredentials=!0),void(n?o.send(JSON.stringify(n)):o.send(null)))}function insertContent(e,n,t){if(!_TConnecto.messageContentInserted[t.id]&&null!=e){if(t.notification.hasDynamicContent&&t.notification.segmentId&&""!==t.notification.segmentId&&t.notification.segmentEvalFunctionResult.result){if(Array.isArray(t.notification.segmentEvalFunctionResult.attrDetails)&&t.notification.segmentEvalFunctionResult.attrDetails.length>0&&Array.isArray(t.notification.segmentEvalFunctionResult.attrDetails[0].events)&&t.notification.segmentEvalFunctionResult.attrDetails[0].events.length>0)var o=t.notification.segmentEvalFunctionResult.attrDetails[0].events[0].properties||t.notification.segmentEvalFunctionResult.attrDetails[0].events[0].data||{};n=_TConnecto.Mustache.render(n,{dynamicContentVariables:_TConnecto.getVariables(),dataLayer:_TConnecto.dataLayer,segmentResult:o})}e.contentWindow.document.open("text/html","replace"),e.contentWindow.document.write(n),e.contentWindow.document.close(),_TConnecto.messageContentInserted[t.id]=!0}}function _getWindowHeight(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0}function _getWindowYscroll(){return window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop||0}function _getDocHeight(){return Math.max(document.body.scrollHeight||0,document.documentElement.scrollHeight||0,document.body.offsetHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0,document.documentElement.clientHeight||0)}function getScrollPercentage(){return(_getWindowYscroll()+_getWindowHeight())/_getDocHeight()*100}function isScrollable(){return _getDocHeight()>_getWindowHeight()}function toggleOnEnterExit(e){e.notification.exitIntent.toggleOnEnterExitVar&&(document.getElementsByTagName("html")[0].addEventListener("mouseenter",(function(){document.getElementById("connecto-modal-overlay-"+e.id).style.display="none",document.getElementById("connecto_"+e.id+"_bg_element").style.display="none"})),document.getElementsByTagName("html")[0].addEventListener("mouseleave",(function(){document.getElementById("connecto-modal-overlay-"+e.id).style.display="block",document.getElementById("connecto_"+e.id+"_bg_element").style.display="block"})))}function showContent(e,n,t,o,i){if(o>0&&isScrollable())window.addEventListener("scroll",(function(){getScrollPercentage()>o?_TConnecto.messageContentInserted[i.id]&&i.notification.hideOnScrollUp?0==_getWindowYscroll()?document.getElementById("container-notification-frame-"+i.id).contentWindow.hideIfShown():document.getElementById("container-notification-frame-"+i.id).contentWindow.showIfHidden():_TConnecto.segmentAndClientSideVariablesOk(i)&&insertContent(e,n,i):_TConnecto.messageContentInserted[i.id]&&i.notification.hideOnScrollUp&&document.getElementById("container-notification-frame-"+i.id).contentWindow.hideIfShown()}),!1);else if(i.notification.exitIntent&&i.notification.exitIntent.showExitIntent)i.notification.dontShowAfter&&i.notification.dontShowAfter>0&&_TConnecto.timeouts.push(setTimeout((function(){_TConnecto.idToExitIntentObjMap[i.id]&&_TConnecto.idToExitIntentObjMap[i.id].disable&&_TConnecto.idToExitIntentObjMap[i.id].disable()}),1e3*i.notification.dontShowAfter)),_TConnecto.timeouts.push(setTimeout((function(){var t=exitIntentLib(document.getElementById("container-notification-frame-"+i.id),{agressive:i.notification.exitIntent.useAgressiveMode||!1,sensitivity:i.notification.exitIntent.sensitivity||65,cookieExpire:i.notification.exitIntent.cookieExpire||0,timer:i.notification.exitIntent.timer||0,cookieDomain:i.notification.exitIntent.cookieDomain||"",id:i.id,callback:function(){_TConnecto.segmentAndClientSideVariablesOk(i)&&(insertContent(e,n,i),toggleOnEnterExit(i))}});_TConnecto.idToExitIntentObjMap[i.id]=t}),t));else if(i.notification.notificationOriginSelector){var c=i.notification.notificationOriginSelector.split(",");for(var a in c)for(var s=document.querySelectorAll(c[a].trim())||[],r=0;r<s.length;r++)s[r].addEventListener(i.notification.notificationOriginEvent,(function(){_TConnecto.segmentAndClientSideVariablesOk(i)&&insertContent(e,n,i)}))}else _TConnecto.timeouts.push(setTimeout((function(){_TConnecto.segmentAndClientSideVariablesOk(i)&&insertContent(e,n,i)}),t))}function _loadScript(e,n){var t=document.createElement("script");t.type="text/javascript",t.readyState?t.onreadystatechange=function(){("loaded"==t.readyState||"complete"==t.readyState)&&(t.onreadystatechange=null,n&&n())}:t.onload=function(){n&&n()},t.src=e,document.getElementsByTagName("head")[0].appendChild(t)}function _checkValueMatch(e,n,t){var o=!1;switch(e){case 1:n.indexOf(t)>=0&&(o=!0);break;case 2:-1===n.indexOf(t)&&(o=!0);break;case 3:n==t&&(o=!0);break;case 4:n!=t&&(o=!0);break;case 5:n>t&&(o=!0);break;case 6:t>n&&(o=!0);break;case 7:n>=t&&(o=!0);break;case 8:t>=n&&(o=!0);break;case 9:null!=n&&(o=!0);break;case 10:null==n&&(o=!0)}return o}function _processConnectoMessages(){if(_TConnecto.messages)for(var e=0;e<_TConnecto.messages.length;e++){var n=_TConnecto.messages[e];if(!_TConnecto.messageProcessed[n.id]&&!_TConnecto.messageContentInserted[n.id])if(!n.notification.hasDynamicContent||_TConnecto.Mustache){if(_TConnecto.pageLoaded||12!==n.notification.notification_type)if(_TConnecto.pageLoaded&&_TConnecto.Sizzle||!n.notification.clientSideVariableMatches||!(n.notification.clientSideVariableMatches.length>0)){var t=htmlUnescape(n.snippet);_TConnecto.messageMap[n.id]=n,_TConnecto.messageProcessed[n.id]=!0;var o;if(12===n.notification.notification_type)_TConnecto.embedElements[n.notification.embeddedSlot]?(o=_TConnecto.embedElements[n.notification.embeddedSlot],o.innerHTML=t):_TConnecto.messageContentInserted[n.id]=!0;else if((o=document.createElement("div")).setAttribute("id","connecto_"+n.id),o.innerHTML=t,document.body)document.body.insertBefore(o,null);else{var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(o,i)}if(5!==n.notification.closeBehaviour){var c=document.getElementById("container-notification-frame-"+n.id),a=htmlUnescape(n.innerHTML);!n.notification.hasDynamicContent||n.notification.segmentId&&""!==n.notification.segmentId||(a=_TConnecto.Mustache.render(a,{dynamicContentVariables:_TConnecto.getVariables(),dataLayer:_TConnecto.dataLayer})),showContent(c,a,n.delay,n.scroll,n)}}else _TConnecto._loadSizzleJS()}else __co_loadMustache()}}function __co_loadMustache(){var e;"undefined"!=typeof Mustache&&(e=Mustache),"undefined"!=typeof require&&"undefined"!=typeof requirejs&&require&&requirejs?(require.config({paths:{_co_mustache:"https://cdnjs.cloudflare.com/ajax/libs/mustache.js/0.8.1/mustache.min"}}),require(["_co_mustache"],(function(e){_TConnecto.Mustache=e}))):_loadScript("https://cdnjs.cloudflare.com/ajax/libs/mustache.js/0.8.1/mustache.min.js",(function(){Mustache&&(_TConnecto.Mustache=Mustache,Mustache=e,_processConnectoMessages())}))}function exitIntentLib(e,n){function t(e,n){return void 0===e?n:e}function o(e){var n=24*e*60*60*1e3,t=new Date;return t.setTime(t.getTime()+n),"; expires="+t.toGMTString()}function i(e){e.clientY>g||s("viewedOnExit"+h,"true")&&!d||(T=setTimeout(r,_))}function c(e){T&&(clearTimeout(T),T=null)}function a(e){S||s("viewedOnExit"+h,"true")&&!d||e.metaKey&&76==e.keyCode&&(S=!0,T=setTimeout(r,_))}function s(e,n){return document.cookie.split("; ").reduce((function(e,n){var t=n.split("=");return e[t[0]]=t[1],e}),{})[e]===n}function r(){l(),f()}function l(){e&&(e.style.display="block"),u()}function u(e){void 0!==(e=e||{}).cookieExpire&&(p=o(e.cookieExpire)),!0===e.sitewide&&(C=";path=/"),void 0!==e.cookieDomain&&(v=";domain="+e.cookieDomain),document.cookie="viewedOnExit"+h+"=true"+p+v+C,y.removeEventListener("mouseleave",i),y.removeEventListener("mouseenter",c),y.removeEventListener("keydown",a)}var d=(n=n||{}).aggressive||!1,g=t(n.sensitivity,65),m=t(n.timer,1e3),_=t(n.delayExit,200),f=n.callback||function(){},p=o(n.cookieExpire)||"",v=n.cookieDomain?";domain="+n.cookieDomain:"",C=!0===n.sitewide?";path=/":"",h=n.id||"",T=null,y=document.getElementsByTagName("html")[0];setTimeout((function(){y.addEventListener("mouseleave",i),y.addEventListener("mouseenter",c),y.addEventListener("keydown",a)}),m);var S=!1;return{fire:l,disable:u}}var _connectoEventStore={vars:{storageHandle:"_Connecto",maxEvents:1e3,sliceBy:10,maxSize:2e5},getHtmlStorage:function(e){if(this.vars.localStore)return this.vars.localStore;var n=e.getItem(this.vars.storageHandle);if(n)try{return JSON.parse(n)}catch(n){return e.removeItem(this.vars.storageHandle),this.initHtmlStorage(e)}return null},initHtmlStorage:function(e){if(e.getItem(this.vars.storageHandle))return this.getHtmlStorage(e);var n={source:document.referrer,landing_page:document.URL,firstVisitOn:new Date,events:[],identity:{}};return e.setItem(this.vars.storageHandle,JSON.stringify(n)),n},initPersistentStorage:function(){return this.initHtmlStorage(localStorage)},saveHtmlStorage:function(e,n){try{e.setItem(this.vars.storageHandle,JSON.stringify(n))}catch(t){JSON.stringify(n).length>this.vars.maxSize&&n.events.length>this.vars.sliceBy&&(n.events=n.events.slice(this.vars.sliceBy),this.saveHtmlStorage(e,n)),console.log(t)}},savePersistentStorage:function(){this.saveHtmlStorage(localStorage,this.vars.localStore)},prunePayload:function(e){try{var n=JSON.parse(JSON.stringify(e));return delete n.messageId,delete n.userId,delete n.anonymousId,delete n.writeKey,delete n.channel,delete n.sentAt,n.context&&(n.context.url=n.context.url.replace(/^.*\/\/[^\/]+/,""),delete n.context.library),n}catch(e){return null}},addEvent:function(e,n){e.events||(e.events=[]),e.events.push(this.prunePayload(n)),e.events.length>this.vars.maxEvents&&(e.events=e.events.slice(this.vars.sliceBy))},saveEvent:function(e){this.vars.localStore||this.init(),this.addEvent(this.vars.localStore,e),this.savePersistentStorage()},setValue:function(e,n,t){e[n]=t},saveValue:function(e,n){this.vars.localStore||this.init(),this.setValue(this.vars.localStore,e,n),this.savePersistentStorage()},getFromHtmlStorage:function(e){var n=this.getHtmlStorage(localStorage);return n&&n[e]?n[e]:null},init:function(){this.vars.localStore=this.initHtmlStorage(localStorage)}},_connecto=_connecto||[];_connecto.HTML5_PERMISSION_KEY="html5PermissionStatus",_connecto.askedForHtml5Permission=!1,_connecto.trackedHtml5Response=!1,_connecto.closeAfterSubscription=!1;var objAgent=navigator.userAgent,objbrowserName=navigator.appName,objfullVersion=""+parseFloat(navigator.appVersion),objBrMajorVersion=parseInt(navigator.appVersion,10),objOffsetVersion;if(-1!=(objOffsetVersion=objAgent.indexOf("Chrome"))&&(objbrowserName="Chrome",objfullVersion=objAgent.substring(objOffsetVersion+7)),objBrMajorVersion=parseInt(""+objfullVersion,10),isNaN(objBrMajorVersion)&&(objfullVersion=""+parseFloat(navigator.appVersion),objBrMajorVersion=parseInt(navigator.appVersion,10)),!window.Notification||"denied"!==Notification.permission&&"granted"!==Notification.permission||(_connecto.trackedHtml5Response=!0),_connecto.onPushSubscription=function(e,n){var t=e.endpoint;e.subscriptionId&&e.endpoint&&-1===e.endpoint.indexOf(e.subscriptionId)&&(t=e);if(_connecto.getFromConnectoStorage("pushSubscriptionEndpoint")!=t){_connecto.saveToConnectoStorage("pushSubscriptionEndpoint",t);var o=_connecto.getAnonymousId(),i=_connecto.getFromConnectoStorage("userId");i||(i=o),_connecto.identify(i,{$chromePushDetails:JSON.stringify(e)},null,(function(){if(_connecto.trackedHtml5Response||(_connecto.getUrlForUserAction(2),_connecto.trackedHtml5Response=!0,_connecto.pushChomePermissionEventToCassandra(2)),_connecto.closeAfterSubscription&&window.close(),null===_connecto.getFromConnectoStorage(_connecto.HTML5_PERMISSION_KEY)){var e={status:Notification.permission,time:new Date};_connecto.saveToConnectoStorage(_connecto.HTML5_PERMISSION_KEY,e),_connecto.setValueInCookie(_connecto.HTML5_PERMISSION_KEY,JSON.stringify(e)),null!==n&&n()}}))}},_connecto.subscribeDevice=function(e,n,t){navigator.serviceWorker.ready.then((function(e){"default"!==Notification.permission||_connecto.askedForHtml5Permission||(_connecto.askedForHtml5Permission=!0,sessionStorage.getItem("haveShownOptInDialog")||(_connecto.getUrlForUserAction(1),_connecto.pushChomePermissionEventToCassandra(1),sessionStorage.setItem("haveShownOptInDialog",!0)));var o={userVisibleOnly:!0};_connecto.VAPIDDetails&&_connecto.VAPIDDetails.publickey&&(o.applicationServerKey=_connecto.urlB64ToUint8Array(_connecto.VAPIDDetails.publickey)),e.pushManager.subscribe(o).then((function(e){_connecto.onPushSubscription(e,n)})).catch((function(e){if(console.log("Error while subscribing: "+e),"denied"!==Notification.permission||_connecto.trackedHtml5Response||(_connecto.getUrlForUserAction(3),_connecto.trackedHtml5Response=!0,_connecto.pushChomePermissionEventToCassandra(3)),null===_connecto.getFromConnectoStorage(_connecto.HTML5_PERMISSION_KEY)){var n={status:Notification.permission,time:new Date};_connecto.saveToConnectoStorage(_connecto.HTML5_PERMISSION_KEY,n),_connecto.setValueInCookie(_connecto.HTML5_PERMISSION_KEY,JSON.stringify(n)),null!==t&&t()}}))}))},_connecto.pushForChrome=function(e,n,t){navigator.serviceWorker.register("/serviceworker.js").then((function(){_connecto.subscribeDevice(e,n,t)})).catch((function(e){console.log(e)}))},_connecto.urlB64ToUint8Array=function(e){for(var n=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),t=window.atob(n),o=new Uint8Array(t.length),i=0;i<t.length;++i)o[i]=t.charCodeAt(i);return o},_connecto.isPushSupported=function(){return navigator&&navigator.serviceWorker?window.Notification?!!(window.PushManager||navigator&&navigator.push)||(console.log("Pushmanager not found."),!1):(console.log("window.Notification not found."),!1):(console.log("Service Workers not supported on this browser. Please upgrade to Chrome 50+"),!1)},_connecto.initPushRegistration=function(e,n,t,o){e&&(_connecto.closeAfterSubscription=!0),_connecto.isPushSupported()&&"Chrome"==objbrowserName&&objBrMajorVersion>=50?_connecto.pushForChrome(e,t,o):null!==n&&n()},_connecto.setSessionDetailsForAsk=function(){sessionStorage.setItem("HTML5_PERMISSION_KEY","true"),_connecto.initPushRegistration()},_connecto.askPermissionViaTimeout=function(e){_connecto.isPushSupported()&&"default"===Notification.permission&&setTimeout((function(){_connecto.setSessionDetailsForAsk()}),1e3*e)},_connecto.urlChanged=function(e){var n=sessionStorage.getItem("HTML5_PERMISSION_KEY");if(_connecto.isPushSupported()&&"default"===Notification.permission&&"true"!==n){var t=location.href,o=_connecto.scriptParametersPerProperty.pushAskUrl,i=_connecto.scriptParametersPerProperty.pushAskTime,c=o&&o.value;t&&c&&t.includes(c)&&(i&&i.enabled&&i.value?_connecto.askPermissionViaTimeout(i.value):_connecto.setSessionDetailsForAsk())}},_connecto.addPopStateEventListener=function(){window.addEventListener("popstate",_connecto.urlChanged)},_connecto.decideAskType=function(){var e=_connecto.scriptParametersPerProperty.pushAskUrl,n=_connecto.scriptParametersPerProperty.pushAskTime;return n&&e&&n.enabled&&e.enabled||e&&e.enabled?_connecto.addPopStateEventListener():n&&n.enabled?n.value?_connecto.askPermissionViaTimeout(n.value):function(){}:void 0},_connecto.fetchScriptParams=function(){var e=_connecto.writeKey,n={context:{url:document.location.href,library:{name:"connecto.js",version:"1.0"}},properties:{writeKey:e}};fetch("https://api.connecto.io/getConnectoScriptParams",{method:"post",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)}).then((function(e){e.json().then((function(e){_connecto.scriptParametersPerProperty=e,_connecto.decideAskType()}))})).catch((function(e){console.log(e)}))},_connecto.isPushSupported()&&"default"===Notification.permission){var haveAlreadyAskedOnce=sessionStorage.getItem("HTML5_PERMISSION_KEY");"true"!==haveAlreadyAskedOnce&&_connecto.fetchScriptParams()}var _connecto=_connecto||[];_connecto.getConnectoStorage=function(){return _connectoEventStore.getHtmlStorage(localStorage)},_connecto.initConnectoStorage=function(){_connectoEventStore.init()},_connecto.saveToConnectoStorage=function(e,n){_connectoEventStore.saveValue(e,n)},_connecto.getFromConnectoStorage=function(e){return _connectoEventStore.getFromHtmlStorage(e)},_connecto.getAnonymousId=function(){var e=_connecto.getFromConnectoStorage("anonymousId");return _connecto.getFromConnectoStorage("isVerified")?e:null},_connecto.getConnectoId=function(){return _connecto.getFromConnectoStorage("anonymousId")},_connecto.getSessionCount=function(){return _connecto.getConnectoId()?2:1},_connecto.pushChomePermissionEventToCassandra=function(e){var n,t;switch(e){case 1:n={userAction:"asked"},t="Push Permission Asked";break;case 2:n={userAction:"allowed"},t="Push Permission Allowed";break;case 3:n={userAction:"denied"},t="Push Permission Denied";break;default:n={}}_connecto.track(t,n,null,(function(){}))},_connecto.getUrlForUserAction=function(e){var n=_connecto.getIdentity();if(n instanceof Function&&(n=_connecto.getConnectoId()),null!==n&&""!==n&&n){var t=document.location.protocol+"//push.connecto.io/chromePush/track";t+="?writeKey="+encodeURIComponent(_connecto.writeKey),t+="&actionType="+encodeURIComponent(e),t+="&profileId="+encodeURIComponent(n),t+="&domain="+encodeURIComponent(window.location.origin),fetch(t)}else setTimeout((function(){_connecto.getUrlForUserAction(e)}),1e3)},_connecto.getQueryStringValue=function(e){return unescape(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+escape(e).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))},_connecto.getDefaultPayload=function(e,n){var t=_connecto.getConnectoId();t&&null!==t&&""!==t||(t=guid(),_connecto.saveToConnectoStorage("anonymousId",t),_connecto.saveToConnectoStorage("isVerified",!1));var o=_connecto.getIdentity(),i=n||new Date,c={utm_source:_connecto.getQueryStringValue("utm_source"),utm_medium:_connecto.getQueryStringValue("utm_medium"),utm_campaign:_connecto.getQueryStringValue("utm_campaign"),utm_content:_connecto.getQueryStringValue("utm_content"),utm_term:_connecto.getQueryStringValue("utm_term")};Object.keys(c).forEach((function(e){c[e]&&null!=c[e]||delete c[e]}));return{messageId:guid(),type:e,userId:o,anonymousId:t,timestamp:i,sessioncount:_connecto.getSessionCount(),context:{url:document.location.href,utm_param:c,library:{name:"connecto.js",version:"1.0"}},writeKey:_connecto.writeKey,channel:"web"}},_connecto.ajax=function(e){var n=e.url,t=e.type||"POST",o=e.dataType||"text/plain",i=e.withCredentials||!0,c=e.success,a=e.data||null,s=e.headers,r=new XMLHttpRequest;r.open(t,n,!0),r.setRequestHeader("content-type",o);for(var l in s)r.setRequestHeader(l,s[l]);r.withCredentials=i,r.onreadystatechange=function(){c&&4==this.readyState&&200==this.status&&c(this.responseText)},a?r.send(JSON.stringify(a)):r.send()},_connecto._sendIdentifyToServer=function(e,n,t){var o=_connecto.getIdentity();return!((t||e&&o&&e===o)&&!_connecto._checkAndUpdateProfileTraits(n,t))},_connecto._checkAndUpdateProfileTraits=function(e,n){var t=_connecto.getFromConnectoStorage("lastTraits")||{};if(n||JSON.stringify(e)!==JSON.stringify(t)){for(var o in e){var i=e[o],c=t[o];c&&c==i&&!n&&delete e[o]}return!0}return!1},_connecto.trackUserIds=function(){try{var e=JSON.parse(localStorage.getItem("MOE_DATA"));if(null===e)return;var n={};if(e.USER_DATA&&e.USER_DATA.attributes){var t=e.USER_DATA.attributes.filter((function(e){return"USER_ATTRIBUTE_UNIQUE_ID"===e.key})),o=t.length>0?t[0]:{};o.value&&""!==o.value&&(n.moengage_user_id=o.value)}var i=e.HARD_ASK_STATUS,c=e.SUBSCRIPTION_DETAILS;i&&"granted"===i&&c&&c.raw&&(c.keys||c.raw.keys)&&(n.$chromePushDetails=JSON.stringify({endpoint:c.raw.endpoint,expirationTime:c.raw.expirationTime,keys:{p256dh:c.raw.keys?c.raw.keys.p256dh:c.keys.p256dh,auth:c.raw.keys?c.raw.keys.auth:c.keys.auth}})),Object.keys(n).length>0&&_connecto.identify(_connecto.getIdentity(),n,null,(function(e){if(e||n.$chromePushDetails&&_connecto.getUrlForUserAction(2),null===_connecto.getFromConnectoStorage(_connecto.HTML5_PERMISSION_KEY)){var t={status:Notification.permission,time:new Date};_connecto.saveToConnectoStorage(_connecto.HTML5_PERMISSION_KEY,t),_connecto.setValueInCookie(_connecto.HTML5_PERMISSION_KEY,JSON.stringify(t))}}))}catch(e){}},_connecto.identify=function(e,n,t,o){e&&null!==e&&""!==e?(function(){if(e instanceof Function||!(e||n&&0!==Object.keys(n).length))o&&o();else{var i=!1;if(t&&t.force&&!0===t.force&&(i=!0),_connecto._sendIdentifyToServer(e,n,i)&&0!==Object.keys(n).length){e&&_connecto.saveToConnectoStorage("userId",e);var c=_connecto.getDefaultPayload("identify",new Date);c.traits=n,t&&t.url&&(c.context.url=t.url);var a=document.location.protocol+"//api.connecto.io/identify";_connecto._sendAndProcessResponse(a,c,o,_connecto.cbToSetAnonymousId)}else o&&o(!0)}})():setTimeout((function(){e=_connecto.getIdentity(),_connecto.identify(e,n,t,o)}),1e3)},_connecto.setIdentifyCookie=function(e){!(function(e,n,t){var o=new Date;o.setTime(o.getTime()+24*t*60*60*1e3);var i="expires="+o.toUTCString();document.cookie=e+"="+n+"; "+i+"; path=/; sameSite=None; secure=true;"})("identifyCookie",e.identifyCookie,3650)},_connecto.saveTraitsToLocalStorage=function(e){var n=_connecto.getFromConnectoStorage("lastTraits")||{};Object.keys(e).forEach((function(t){n[t]=e[t]})),_connecto.saveToConnectoStorage("lastTraits",n)},_connecto._sendAndProcessResponse=function(e,n,t,o){n.sentAt=new Date,_connecto.ajax({url:e,data:n,success:function(e){if(res=JSON.parse(e),"identify"===n.type){var i=n.traits;_connecto.saveTraitsToLocalStorage(i)}o&&o(res),t&&t(),res.identifyCookie&&_connecto.setIdentifyCookie(res)}}),_connectoEventStore.saveEvent(n)},_connecto.setValueInCookie=function(e,n){!(function(e,n,t){var o=new Date;o.setTime(o.getTime()+24*t*60*60*1e3);var i="expires="+o.toUTCString();document.cookie="_CO_"+e+"="+escape(n)+"; "+i+"; sameSite=None; secure=true;"})(e,n,3650)},_connecto.cbToSetAnonymousId=function(e){if(e.anonymousId){var n=e.anonymousId,t=_connecto.getConnectoId(),o=_connecto.getFromConnectoStorage("isVerified");(n!==t||n===t&&!o)&&(_connecto.saveToConnectoStorage("anonymousId",n),_connecto.setValueInCookie("anonymousId",n),_connecto.setValueInCookie("type","connecto"),_connecto.saveToConnectoStorage("isVerified",!0))}},_connecto.track=function(e,n,t,o){var i=_connecto.getDefaultPayload("track",new Date);i.event=e,i.properties=n,-1!==e.indexOf("Push Permission")&&i&&i.context&&i.context.library&&(i.context.library.name="connecto-backend"),t&&t.url&&(i.context.url=t.url);var c=document.location.protocol+"//api.connecto.io/track";_connecto._sendAndProcessResponse(c,i,o,_connecto.cbToSetAnonymousId)},_connecto.generatedEvents=function(e,n,t,o){var i=_connecto.getDefaultPayload("track",new Date);i.event=e,i.properties=n,-1!==e.indexOf("Push Permission")&&i&&i.context&&i.context.library&&(i.context.library.name="connecto-backend"),t&&t.url&&(i.context.url=t.url);var c=document.location.protocol+"//api.connecto.io/generatedEvents";_connecto._sendAndProcessResponse(c,i,o,_connecto.cbToSetAnonymousId)},_connecto.transaction=function(e,n,t,o){var i=_connecto.getDefaultPayload("transaction",new Date);i.event=e,i.properties=n,t&&t.url&&(i.context.url=t.url);var c=document.location.protocol+"//api.connecto.io/transaction";_connecto._sendAndProcessResponse(c,i,o,_connecto.cbToSetAnonymousId)},_connecto.page=function(e,n,t){var o=_connecto.getDefaultPayload("page",new Date);e&&(o.data=e),n&&n.url&&(o.context.url=n.url);var i=document.location.protocol+"//api.connecto.io/page";_connecto._sendAndProcessResponse(i,o,t,_connecto.cbToSetAnonymousId)},_connecto.onload=function(e){e&&e()},_connecto.processOnLoad=function(){for(var e=_connecto.length,n=0;e>n;n++)_connecto._processPushedFunction(_connecto.shift())},_connecto._processPushedFunction=function(e){var n=e.shift();_connecto[n]&&_connecto[n].apply(null,e)},_connecto.push=function(e){_connecto._processPushedFunction(e)},_connecto.getIdentity=function(){var e=_connecto.getFromConnectoStorage("userId");return(!e||e instanceof Function)&&(e=_connecto.getConnectoId()),e},_connecto.initialized?window.console&&console.error&&console.error("Connecto Snippet Included Twice"):(_connecto.initialized=!0,_connecto.processOnLoad(),_connecto.initConnectoStorage());var _TConnecto=_TConnecto||{};_TConnecto.initPage=function(e){if(_TConnecto.clearMessages(),_TConnecto.initialized=!1,_TConnecto.pageLoaded=_TConnecto.pageLoaded||!1,_TConnecto.variables=_TConnecto.variables||{},_TConnecto.messages=null,_TConnecto.messageContentInserted={},_TConnecto.messageProcessed={},_TConnecto.embedElements={},_TConnecto.messageMap={},_TConnecto.usesNewVariables=!1,_TConnecto.idToExitIntentObjMap)for(var n in _TConnecto.idToExitIntentObjMap)_TConnecto.idToExitIntentObjMap[n]&&_TConnecto.idToExitIntentObjMap[n].disable&&_TConnecto.idToExitIntentObjMap[n].disable();if(_TConnecto.idToExitIntentObjMap={},_TConnecto.timeouts&&_TConnecto.timeouts.length>0)for(var t=0;t<_TConnecto.timeouts.length;t++)clearTimeout(_TConnecto.timeouts[t]);_TConnecto.timeouts=[],e&&fetchMessages()};var fetchMessages=function(){_TConnecto.dataLayer=_TConnecto.dataLayer||window.dataLayer;var e=_TConnecto.getFromConnectoStorage("firstVisitOn"),n=_TConnecto.getFromConnectoStorage("landingPage"),t={};try{_TConnecto.updateConnectoLogs();var o=_TConnecto.initConnectoStorage().source,i=_TConnecto.getConnectoLogs(),c=_TConnecto.getEventsSummary(),a=1,s=1,r=null;i&&i.sessions&&(a=i.sessions.length)>0&&(s=i.sessions[a-1].pagesViewed,r=i.sessions[a-1].startTime),e&&(t.firstVisitTime=e),c&&(t.eventsSummary=c),n&&(t.landingPage=n),o&&(t.referer=o),a&&(t.sessionNum=a),s&&(t.sessionLen=s),r&&(t.sessionStart=r),_TConnecto.engageId&&(t.engageId=_TConnecto.engageId),_TConnecto.getVariables()&&(t.customVariables=JSON.stringify(_TConnecto.getVariables())),_TConnecto.licenseKey&&(t.licenseKey=_TConnecto.licenseKey);var l=_TConnecto.getAnonymousId(),u=_TConnecto.getIdentity(),d={};u&&(d.userId=u),l&&(d.anonymousId=l),d&&(t.segmentData=JSON.stringify(d)),_TConnecto.saveToConnectoStorage("lastVisitTime",new Date)}catch(e){console.log("Error : err"+e),console.log("Error : stack"+e.stack)}ajaxCall(document.location.protocol+"//server.connecto.io/?v=1.2&url="+encodeURIComponent(window.location),t,(function(e){if(res=JSON.parse(e),"1"==res.response||"2"==res.response){for(var n=0;n<res.messages.length;n++){var t=res.messages[n];if(t.imagesToPreload)for(var o=0;o<t.imagesToPreload.length;o++)if(document.images&&t.imagesToPreload[o]){(new Image).src=t.imagesToPreload[o]}}_TConnecto.messages=res.messages,res.groups&&(_TConnecto.groups=res.groups),"interactive"==document.readyState||"complete"==document.readyState?_TConnecto._processOnPageLoad():window.addEventListener("DOMContentLoaded",_TConnecto._processOnPageLoad)}}))};_TConnecto.trackConversion=function(e){if(e=e||window._connecto_cur_msg_id){ajaxCall(document.location.protocol+"//server.connecto.io/action?action=8&id="+e),_TConnecto.resetMessageId()}},_TConnecto.resetMessageId=function(){delete window._connecto_cur_msg_id},_TConnecto.clearMessages=function(){if("object"==typeof _TConnecto.messageContentInserted)for(var e in _TConnecto.messageContentInserted){var n=document.getElementById("connecto_"+e);n&&n.remove()}},_TConnecto.initPage(),_TConnecto.addVariable=function(e,n){_TConnecto.usesNewVariables=!0,e&&n&&(_TConnecto.variables[e]=n)},_TConnecto.getVariables=function(){if(!_TConnecto.usesNewVariables&&(_TConnecto.customVariables&&(_TConnecto.variables=_TConnecto.customVariables),_TConnecto.dynamicVariables))for(var e in _TConnecto.dynamicVariables)_TConnecto.variables[e]=_TConnecto.dynamicVariables[e];return _TConnecto.variables},_TConnecto.segmentAndClientSideVariablesOk=function(e){var n=e.notification.segmentId;return _TConnecto._evaluateSegmentEvalFn(e.notification),!(n&&""!==n&&!e.notification.segmentEvalFunctionResult.result)&&!(e.notification.clientSideVariableMatches&&e.notification.clientSideVariableMatches.length>0&&!_TConnecto.matchClientSideVariables(e.notification.clientSideVariableMatches,e.notification))},_TConnecto.matchClientSideVariables=function(andClauses,notification){for(var conjunction=!0,i=0;i<andClauses.length;i++){for(var disjunction=!1,orClauses=andClauses[i].orClauses,j=0;j<orClauses.length;j++){var clauseType=orClauses[j].clauseType,selector=orClauses[j].selector,dataLayerVariable="_TConnecto.dataLayer"+orClauses[j].dataLayerVariable,matchType=orClauses[j].matchType,value=orClauses[j].value,clauseMatch=!1;if(1==clauseType&&selector&&matchType&&value){var selectorElements=_TConnecto.Sizzle(selector);if(selectorElements&&selectorElements.length>0){var selectorValue=selectorElements[0].textContent;selectorValue=selectorValue.toUpperCase(),value=value.toUpperCase(),_checkValueMatch(matchType,selectorValue,value)&&(clauseMatch=!0)}}else if(2==clauseType&&_TConnecto.dataLayer&&dataLayerVariable&&matchType)try{var evaluatedDataLayerValue=eval(dataLayerVariable);evaluatedDataLayerValue=evaluatedDataLayerValue.toUpperCase(),value=value.toUpperCase(),_checkValueMatch(matchType,evaluatedDataLayerValue,value)&&(clauseMatch=!0)}catch(e){}else if(3==clauseType&&value)clauseMatch=eval("("+orClauses[j].value+")()");else if(4==clauseType&&_TConnecto.dataLayer&&dataLayerVariable&&matchType)try{var evaluatedDataLayerValue=eval(dataLayerVariable);evaluatedDataLayerValue=evaluatedDataLayerValue.toUpperCase();var segmentEvalFunctionResults=[];if(notification.segmentEvalFunctionResult&&notification.segmentEvalFunctionResult.attrDetails)for(var index in notification.segmentEvalFunctionResult.attrDetails){var attrDetail=notification.segmentEvalFunctionResult.attrDetails[index];segmentEvalFunctionResults.push(attrDetail.joinAttrVal.toUpperCase())}1!=matchType&&2!=matchType||!_checkValueMatch(matchType,segmentEvalFunctionResults,evaluatedDataLayerValue)||(clauseMatch=!0)}catch(e){}disjunction=disjunction||clauseMatch}conjunction=conjunction&&disjunction}return conjunction},_TConnecto._loadSizzleJS=function(){var e;"undefined"!=typeof Sizzle&&(e=Sizzle),"undefined"!=typeof require&&"undefined"!=typeof requirejs&&require&&requirejs?(require.config({paths:{_co_sizzle:"https://cdnjs.cloudflare.com/ajax/libs/sizzle/2.2.0/sizzle.min"}}),require(["_co_sizzle"],(function(e){_TConnecto.Sizzle=e}))):_loadScript("https://cdnjs.cloudflare.com/ajax/libs/sizzle/2.2.0/sizzle.min.js",(function(){Sizzle&&(_TConnecto.Sizzle=Sizzle,Sizzle=e,_processConnectoMessages())}))},_TConnecto.getMessage=function(e){return _TConnecto.messageMap[e]?_TConnecto.messageMap[e].notification:null},_TConnecto.showMessage=function(e){if(_TConnecto.messageMap[e])if(_TConnecto.messageContentInserted[e])document.getElementById("container-notification-frame-"+e).contentWindow.toggleWidget();else{var n=_TConnecto.messageMap[e];showContent(document.getElementById("container-notification-frame-"+n.id),htmlUnescape(n.innerHTML),n.delay,n.scroll,n)}},_TConnecto.stopMessage=function(e){_TConnecto.messageContentInserted[e]=!0},_TConnecto.getConnectoStorage=function(e){var n=localStorage.getItem(e);if(n)try{return JSON.parse(n)}catch(e){return{}}return null},_TConnecto.initConnectoStorage=function(){if(localStorage.getItem("_connecto"))return _TConnecto.getConnectoStorage("_connecto");var e={source:document.referrer,landingPage:document.URL,firstVisitOn:new Date};return localStorage.setItem("_connecto",JSON.stringify(e)),e},_TConnecto.saveToConnectoStorage=function(e,n){var t=_TConnecto.getConnectoStorage("_connecto");t||(t=_TConnecto.initConnectoStorage()),t[e]=n,localStorage.setItem("_connecto",JSON.stringify(t))},_TConnecto.connectoLogsUpdated=!1,_TConnecto.updateConnectoLogs=function(){if(!_TConnecto.connectoLogsUpdated){var e=_TConnecto.getConnectoLogs(),n=new Date;if(e.pages.push({url:window.location.href,time:n}),e.sessions.length>0&&_TConnecto._readCookie("_co_session_active")){var t=e.sessions[e.sessions.length-1];t.pagesViewed=t.pagesViewed?t.pagesViewed+1:1,t.lastPageLoadTime=n}else e.sessions.push({startTime:n.getTime(),pagesViewed:1});var o=new Date;o.setTime(n.getTime()+144e5),document.cookie="_co_session_active=1;expires="+o.toGMTString()+"; path=/",e.pages.length>100&&e.pages.shift(),e.sessions.length>50&&e.sessions.shift(),localStorage.setItem("_connecto_logs",JSON.stringify(e)),_TConnecto.connectoLogsUpdated=!0}},_TConnecto.getConnectoLogs=function(){var e={pages:[],sessions:[]},n=e,t=localStorage.getItem("_connecto_logs");if(t)try{n=JSON.parse(t)}catch(e){console.log("Error1 : err"+e),console.log("Error1 : stack"+e.stack)}return n||(n=e),n.pages&&"[object Array]"===Object.prototype.toString.call(n.pages)||(n.pages=[]),n.sessions&&"[object Array]"===Object.prototype.toString.call(n.sessions)||(n.sessions=[]),n},_TConnecto.getEventsSummary=function(){var e=localStorage.getItem("_co_events");if(e)try{return connectoEvents=JSON.parse(e),connectoEvents.summary}catch(e){console.log("Error1 : err"+e),console.log("Error1 : stack"+e.stack)}return null},_TConnecto._readCookie=function(e){for(var n=e+"=",t=document.cookie.split(";"),o=0;o<t.length;o++){for(var i=t[o];" "==i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(n))return i.substring(n.length,i.length)}return null},_TConnecto.getIdentity=function(){var e=_TConnecto.getFromConnectoEventStorage("userId");return e||(e=_TConnecto.getAnonymousId()),e},_TConnecto.getAnonymousId=function(){return _TConnecto.getFromConnectoEventStorage("anonymousId")},_TConnecto.getFromConnectoEventStorage=function(e){var n=_TConnecto.getConnectoStorage("_Connecto");return n&&n[e]?n[e]:null},_TConnecto.getFromConnectoStorage=function(e){var n=_TConnecto.getConnectoStorage("_connecto");return n&&n[e]?n[e]:null},_TConnecto.updateState=function(id,state,data){if("string"==typeof id)var msg=_TConnecto.getMessage(id);else msg=id;if(msg&&msg.triggerNotifications&&msg.triggerNotifications.callbackClick&&1==state&&eval("("+msg.triggerNotifications.callbackClick+")("+JSON.stringify(data)+")"),msg&&msg.triggerNotifications&&msg.triggerNotifications.callbackClose&&0==state&&eval("("+msg.triggerNotifications.callbackClose+")()"),_TConnecto.groups)for(var i=0;i<_TConnecto.groups.length;i++){var group=_TConnecto.groups[i];if(group.dontShowAfterFill&&1==state||group.dontShowAfterClose&&0==state)for(var j=0;j<_TConnecto.messages.length;j++){var message=_TConnecto.messages[j];_TConnecto.messageContentInserted[message.id]=!0}}},_TConnecto._processOnPageLoad=function(){_TConnecto.pageLoaded=!0;for(var e=document.getElementsByTagName("ins"),n="",t=0;t<e.length;t++){var o=e[t].getAttribute("class");o&&o.indexOf("connecto-notification")>-1&&(n=e[t].getAttribute("data-connecto-slot"))&&(_TConnecto.embedElements[n]=e[t])}_processConnectoMessages()},_TConnecto._evaluateSegmentEvalFn=function(notification){if(notification.segmentId&&""!==notification.segmentId)try{notification.segmentEvalFunctionResult=eval(notification.segmentEvalFunction)}catch(e){console.log("It shoudn't have happened, check the evalFn of notificationId: "+notification._id),notification.segmentEvalFunctionResult={result:!1}}},_TConnecto.initialized||(_TConnecto.initialized=!0,"function"==typeof _TConnecto.initConnecto&&_TConnecto.initConnecto(),fetchMessages());